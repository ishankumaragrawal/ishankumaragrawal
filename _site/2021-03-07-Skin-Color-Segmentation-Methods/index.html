<!DOCTYPE html>
<html lang="en">
<!-- Beautiful Jekyll 5.0.0 | Copyright Dean Attali 2020 -->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  

  

  <title>Skin Segmentation in Images</title>

  
  <meta name="author" content="Ishan Kumar">
  

  <meta name="description" content="This posts explains various ways through which you can segment out the color of the skin from the rest of the image.">

  
  <meta name="theme-color" content="#0085A1">
  

  
  <meta name="keywords" content="Ishan,ishan,kumar,Kumar,Ishan Kumar,ishan kumar, IIT Roorkee, DSG, Ishan Kumar IITR, Ishan Kumar IIT Roorkee, Ishan Kumar Agrawal, Ishan Kumar Aggrawal, Ishan Kumar Agarwal, ishan kumar agrawal, Ishan K Agrawal">
  

  <link rel="alternate" type="application/rss+xml" title="Ishan Kumar" href="http://localhost:4001/feed.xml">

  

  

  
<!-- Google Analytics -->
<script>
  (function (i, s, o, g, r, a, m) {
    i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
      (i[r].q = i[r].q || []).push(arguments)
    }, i[r].l = 1 * new Date(); a = s.createElement(o),
      m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
  })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
  ga('create', 'UA-195294169-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- End Google Analytics -->



  
    
      
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">


    
      
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css">


    
      
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic">


    
      
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800">


    
  

  
    
      <link rel="stylesheet" href="/assets/css/bootstrap-social.css">
    
      <link rel="stylesheet" href="/assets/css/beautifuljekyll.css">
    
  

  

  
  
  

  

  
  <meta property="og:site_name" content="Ishan Kumar">
  <meta property="og:title" content="Skin Segmentation in Images">
  <meta property="og:description" content="This posts explains various ways through which you can segment out the color of the skin from the rest of the image.">

  
  <meta property="og:image" content="http://localhost:4001/assets/img/background.png">
  

  
  <meta property="og:type" content="article">
  <meta property="og:article:author" content="Ishan Kumar">
  <meta property="og:article:published_time" content="2021-03-07T00:00:00+00:00">
  <meta property="og:url" content="http://localhost:4001/2021-03-07-Skin-Color-Segmentation-Methods/">
  <link rel="canonical" href="http://localhost:4001/2021-03-07-Skin-Color-Segmentation-Methods/">
  

  
  <meta name="twitter:card" content="summary_large_image">
  
  <meta name="twitter:site" content="@ishankumar216">
  <meta name="twitter:creator" content="@ishankumar216">

  <meta property="twitter:title" content="Skin Segmentation in Images">
  <meta property="twitter:description" content="This posts explains various ways through which you can segment out the color of the skin from the rest of the image.">

  
  <meta name="twitter:image" content="http://localhost:4001/assets/img/background.png">
  

  


  

  

</head>


<body>

  


  <nav class="navbar navbar-expand-xl navbar-light fixed-top navbar-custom top-nav-regular"><a class="navbar-brand" href="http://localhost:4001/">Ishan Kumar</a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="main-navbar">
    <ul class="navbar-nav ml-auto">
          <li class="nav-item">
            <a class="nav-link" href="/index">About Me</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/blogs">Blogs</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/projects">Projects</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="https://drive.google.com/file/d/1pyML__Wo-llOx6Qv6q5yaPmS2vCP9lWX/view?usp=sharing">CV</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/courses">Courses</a>
          </li></ul>
  </div>

  

  
    <div class="avatar-container">
      <div class="avatar-img-border">
        <a href="http://localhost:4001/">
          <img alt="Navigation bar avatar" class="avatar-img" src="/assets/img/photo_ishan.png" />
        </a>
      </div>
    </div>
  

</nav>


  <!-- TODO this file has become a mess, refactor it -->






  <div id="header-big-imgs" data-num-img=1
    
    
    
      
      data-img-src-1="http://localhost:4001/assets/img/background.png"
    
    
    
  ></div>


<header class="header-section has-img">

<div class="big-img intro-header">
  <div class="container-md">
    <div class="row">
      <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
        <div class="post-heading">
          <h1>Skin Segmentation in Images</h1>
          
            
              <h2 class="post-subheading">This posts explains various ways through which you can segment out the color of the skin from the rest of the image.</h2>
            
          

          
            <span class="post-meta">Posted on March 7, 2021</span>
            
            
          
        </div>
      </div>
    </div>
  </div>
  <span class='img-desc'></span>
</div>

<div class="intro-header no-img">
  <div class="container-md">
    <div class="row">
      <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
        <div class="post-heading">
          <h1>Skin Segmentation in Images</h1>
          
            
              <h2 class="post-subheading">This posts explains various ways through which you can segment out the color of the skin from the rest of the image.</h2>
            
          

          
            <span class="post-meta">Posted on March 7, 2021</span>
            
            
          
        </div>
      </div>
    </div>
  </div>
</div>
</header>





<div class=" container-md ">
  <div class="row">
    <div class=" col-xl-8 offset-xl-2 col-lg-12 offset-lg-1 ">

      

      

      <article role="main" class="blog-post">
        <p>Skin Segmentation can be a important aspect of pre-processing data for Deep Learning Models. It can be used whenever you are making a model which works on Hands, Faces etc. Unlike segmentation in other tasks (like <a href="https://arxiv.org/abs/2005.05218">this</a> or <a href="https://arxiv.org/abs/2001.04074">this</a> ) here it can be done without using a huge DL model.
Some of these methods work only for segmenting out the parts of skin from rest of the image, while rest can be used for segmenting foreground from background in general.</p>

<p>It cant be assumed that a model working better in my examples would also work better in your usecase, hence I would suggest to try all and also try by altering the thresholds a little to make it best for your use.</p>

<h2 id="1-using-rgb-thresholding">1. Using RGB Thresholding</h2>
<p>Thresholding is the most simple and fast method of doing this. The way this method works is it assumes skin colors to be clustered near each other on the RGB model, and allows only values between those thresholds hence masking out the rest.</p>

<p>Here you can try and make the thresholds tighter or looser based on what works best for your usecase.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">def</span> <span class="nf">RGBMasking</span><span class="p">(</span><span class="n">img</span><span class="p">,</span><span class="n">bbox</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="s">"""
    Segments the Hand from the Image, using RGB Rules
    Parameters
    ----------
    img: The image itself [H, W, 3/4]
    bbox: Bounding Box of the desired object format [x_min, x_max, y_min, y_max]
    """</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">img</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">].</span><span class="n">clone</span><span class="p">()</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">img</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">].</span><span class="n">clone</span><span class="p">()</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">img</span><span class="p">[:,:,</span><span class="mi">2</span><span class="p">].</span><span class="n">clone</span><span class="p">()</span>

    <span class="n">rule_rgb</span> <span class="o">=</span> <span class="p">(</span><span class="n">r</span> <span class="o">&gt;</span> <span class="mf">0.3725</span><span class="p">).</span><span class="nb">int</span><span class="p">()</span><span class="o">*</span><span class="p">(</span><span class="n">g</span> <span class="o">&gt;</span> <span class="mf">0.156</span><span class="p">).</span><span class="nb">int</span><span class="p">()</span><span class="o">*</span><span class="p">(</span><span class="n">b</span> <span class="o">&gt;</span> <span class="mf">0.0784</span><span class="p">).</span><span class="nb">int</span><span class="p">()</span><span class="o">*</span><span class="p">(</span><span class="n">r</span> <span class="o">&gt;</span> <span class="n">g</span><span class="p">).</span><span class="nb">int</span><span class="p">()</span><span class="o">*</span><span class="p">(</span><span class="n">r</span> <span class="o">&gt;</span> <span class="n">b</span><span class="p">).</span><span class="nb">int</span><span class="p">()</span><span class="o">*</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="n">g</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0588</span><span class="p">).</span><span class="nb">int</span><span class="p">()</span>
    
    <span class="n">rgb_ruled_img</span> <span class="o">=</span> <span class="n">img</span><span class="p">[:,:,:</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="n">rule_rgb</span><span class="p">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">2</span><span class="p">).</span><span class="n">repeat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    
    <span class="c1">#Removing everything detected outside bounding box if its provided
</span>    <span class="k">if</span> <span class="n">bbox</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">bbox_mask</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">rgb_ruled_img</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">rgb_ruled_img</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">rgb_ruled_img</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
        <span class="n">bbox_mask</span><span class="p">[</span><span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">bbox</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span><span class="n">bbox</span><span class="p">[</span><span class="mi">3</span><span class="p">],:]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">rgb_ruled_img</span> <span class="o">*=</span> <span class="n">bbox_mask</span>
        
    <span class="k">return</span> <span class="n">rgb_ruled_img</span>


</code></pre></div></div>

<p><img src="../assets/img/rgb.png" alt="RGB Results" class="mx-auto d-block" /></p>

<h2 id="2-using-hsv-thresholding">2. Using HSV Thresholding</h2>

<p>The HSV Color Model is another model to define the color spectrum similar to RGB Model.
Here the parameters are H(Hue), S(Saturation) and V(Value or Brightness)</p>

<p>This color model is used more for skin segemntation, although it doesnt perform as well as RGB in this usecase of hands.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">HSVMasking</span><span class="p">(</span><span class="n">img</span><span class="p">,</span><span class="n">bbox</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="s">"""
    Segments the Hand from the Image, using HSV Rules
    Parameters
    ----------
    img: The image itself [H, W, 3/4]
    bbox: Bounding Box of the desired object format -[x_min, x_max, y_min, y_max]
    """</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">img</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">].</span><span class="n">clone</span><span class="p">()</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">img</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">].</span><span class="n">clone</span><span class="p">()</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">img</span><span class="p">[:,:,</span><span class="mi">2</span><span class="p">].</span><span class="n">clone</span><span class="p">()</span>

    <span class="c1">#Converting RGB to HSV
</span>    <span class="c1">#cv2.cvtColor(self.image, cv2.COLOR_RGB2HSV) can also be used
</span>    
    <span class="n">max_clr</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="nb">max</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="n">r</span><span class="p">,</span><span class="n">other</span><span class="o">=</span><span class="n">g</span><span class="p">)</span>
    <span class="n">max_clr</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="nb">max</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="n">max_clr</span><span class="p">,</span><span class="n">other</span><span class="o">=</span><span class="n">b</span><span class="p">)</span>

    <span class="n">min_clr</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="nb">min</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="n">r</span><span class="p">,</span><span class="n">other</span><span class="o">=</span><span class="n">g</span><span class="p">)</span>
    <span class="n">min_clr</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="nb">min</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="n">min_clr</span><span class="p">,</span><span class="n">other</span><span class="o">=</span><span class="n">b</span><span class="p">)</span>

    <span class="n">diff</span> <span class="o">=</span> <span class="n">max_clr</span> <span class="o">-</span> <span class="n">min_clr</span>

    <span class="n">H</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

    <span class="n">zero_t</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

    <span class="n">H</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">where</span><span class="p">(</span><span class="n">max_clr</span> <span class="o">==</span> <span class="n">r</span><span class="p">,</span> <span class="p">(</span><span class="mi">60</span> <span class="o">*</span> <span class="p">((</span><span class="n">g</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="o">/</span> <span class="n">diff</span><span class="p">)</span> <span class="o">+</span> <span class="mi">360</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span><span class="p">,</span> <span class="n">H</span><span class="p">)</span>
    <span class="n">H</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">where</span><span class="p">(</span><span class="n">max_clr</span> <span class="o">==</span> <span class="n">g</span><span class="p">,</span> <span class="p">(</span><span class="mi">60</span> <span class="o">*</span> <span class="p">((</span><span class="n">b</span> <span class="o">-</span> <span class="n">r</span><span class="p">)</span> <span class="o">/</span> <span class="n">diff</span><span class="p">)</span> <span class="o">+</span> <span class="mi">120</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span><span class="p">,</span> <span class="n">H</span><span class="p">)</span>
    <span class="n">H</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">where</span><span class="p">(</span><span class="n">max_clr</span> <span class="o">==</span> <span class="n">b</span><span class="p">,</span> <span class="p">(</span><span class="mi">60</span> <span class="o">*</span> <span class="p">((</span><span class="n">r</span> <span class="o">-</span> <span class="n">g</span><span class="p">)</span> <span class="o">/</span> <span class="n">diff</span><span class="p">)</span> <span class="o">+</span> <span class="mi">240</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span><span class="p">,</span> <span class="n">H</span><span class="p">)</span>
    <span class="n">H</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">where</span><span class="p">(</span><span class="n">max_clr</span> <span class="o">==</span> <span class="n">min_clr</span><span class="p">,</span> <span class="n">zero_t</span><span class="p">,</span> <span class="n">H</span><span class="p">)</span>

    <span class="n">H</span> <span class="o">=</span> <span class="n">H</span><span class="o">/</span><span class="mi">360</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">where</span><span class="p">(</span><span class="n">max_clr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">zero_t</span><span class="p">,</span> <span class="n">diff</span><span class="o">/</span><span class="n">max_clr</span><span class="p">)</span>
    <span class="n">V</span> <span class="o">=</span> <span class="n">max_clr</span>
    
    <span class="c1">#Thresholding    
</span>    <span class="n">hsv_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">H</span> <span class="o">&lt;</span> <span class="mf">0.1388</span><span class="p">).</span><span class="nb">int</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="n">S</span> <span class="o">&lt;</span> <span class="mf">0.68</span><span class="p">).</span><span class="nb">int</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="n">S</span> <span class="o">&gt;</span> <span class="mf">0.18</span><span class="p">).</span><span class="nb">int</span><span class="p">()</span>
        
    <span class="n">hsv_ruled_img</span> <span class="o">=</span> <span class="n">img</span><span class="p">[:,:,:</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="n">hsv_mask</span><span class="p">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">2</span><span class="p">).</span><span class="n">repeat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">bbox</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">bbox_mask</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">hsv_ruled_img</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">hsv_ruled_img</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">hsv_ruled_img</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
        <span class="n">bbox_mask</span><span class="p">[</span><span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">bbox</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span><span class="n">bbox</span><span class="p">[</span><span class="mi">3</span><span class="p">],:]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">hsv_ruled_img</span> <span class="o">*=</span> <span class="n">bbox_mask</span>
        
    <span class="k">return</span> <span class="n">hsv_ruled_img</span>

</code></pre></div></div>

<p><img src="../assets/img/hsv_2.png" alt="HSV Results" class="mx-auto d-block" /></p>

<h2 id="3-grabcut">3. GrabCut</h2>
<p>This is a algorithm introduced in the paper by Roth et. al. <a href="https://dl.acm.org/doi/10.1145/1186562.1015720">[link to paper]</a> and does the task of seperating forground from background with minimum user interaction. 
Although this algorithm is fairly simple to use an gives exceptionally good results, it has to be kept in mind that it <strong>can only be used when the skin (subject) is in the foreground</strong>.</p>

<p>This algorithm also needs a <strong>Bounding Box</strong>. 
If you dataset doesnt give that, fret not as it work fairly well for a general loose bounding box which can be easily made if your subject is centered (which it should considering GrabCut works only for foreground seperation).</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">GrabCut</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="s">"""
    Segments the Hand from the Image, using the GrabCut Algo
    Parameters
    ----------
    img: The image itself [H, W, 3/4]
    bbox: Bounding Box of the desired object format -[x_min, y_min, len_x, len_y]
    """</span>
    <span class="c1">#If the input is RGBA remove the A channel as CV2 requires RGB
</span>    <span class="n">img</span> <span class="o">=</span> <span class="n">img</span><span class="p">[:,:,:</span><span class="mi">3</span><span class="p">]</span>
    <span class="c1">#If you are inputting 
</span>    <span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cv2</span><span class="p">.</span><span class="n">COLOR_RGB2BGR</span><span class="p">)</span>
    
    <span class="n">bgdModel</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">65</span><span class="p">),</span><span class="n">np</span><span class="p">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">fgdModel</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">65</span><span class="p">),</span><span class="n">np</span><span class="p">.</span><span class="n">float64</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">bbox</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>
    
    <span class="n">mask</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">img_rgb</span><span class="p">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span><span class="n">np</span><span class="p">.</span><span class="n">uint8</span><span class="p">)</span>
    <span class="n">cv2</span><span class="p">.</span><span class="n">grabCut</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">bbox</span><span class="p">,</span> <span class="n">bgdModel</span><span class="p">,</span> <span class="n">fgdModel</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">cv2</span><span class="p">.</span><span class="n">GC_INIT_WITH_RECT</span><span class="p">)</span>
    
    <span class="n">mask2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">where</span><span class="p">((</span><span class="n">mask</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span><span class="o">|</span><span class="p">(</span><span class="n">mask</span><span class="o">==</span><span class="mi">0</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">).</span><span class="n">astype</span><span class="p">(</span><span class="s">'uint8'</span><span class="p">)</span>
    
    <span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cv2</span><span class="p">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">img</span><span class="p">[:,:,:</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">mask2</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">np</span><span class="p">.</span><span class="n">newaxis</span><span class="p">].</span><span class="n">repeat</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="../assets/img/grabcut.png" alt="HSV Results" class="mx-auto d-block" /></p>

<p>Apart from these you can also try to <strong>combine these methods</strong>. For instance the mask param of GrabCut, can be replaced by the mask produced by RGB or HSV (sort of like a good initialisation). This would lead to the best accuracy.</p>

<p>For more depth check out these papers-</p>
<ol>
  <li>
    <p>Shah et. al. Combinatorial Color Space Models for Skin Detection in Sub-continental Human Images <a href="https://www.researchgate.net/publication/221365117_Combinatorial_Color_Space_Models_for_Skin_Detection_in_Sub-continental_Human_Images">link</a></p>
  </li>
  <li>
    <p>Kolkur et. al. Human Skin Detection Using RGB, HSV and YCbCr Color
Models <a href="https://arxiv.org/pdf/1708.02694.pdf">link</a></p>
  </li>
</ol>


      </article>

      
        <div class="blog-tags">
          <span>Tags:</span>
          
            <a href="/tags#Computer Vision">Computer Vision</a>
          
        </div>
      

      

      

      <ul class="pagination blog-pager">
        
        <li class="page-item previous">
          <a class="page-link" href="/2021-03-07-BART-and-MBART/" data-toggle="tooltip" data-placement="top" title="BART and MBART">&larr; Previous Post</a>
        </li>
        
        
        <li class="page-item next">
          <a class="page-link" href="/2021-10-21-MT_Using_Ignite/" data-toggle="tooltip" data-placement="top" title="Machine Translation using PyTorch Ignite">Next Post &rarr;</a>
        </li>
        
      </ul>
      
  
  
  

  




    </div>
  </div>
</div>


  <footer>
  <div class="container-md beautiful-jekyll-footer">
    <div class="row">
      <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
      <ul class="list-inline text-center footer-links"><li class="list-inline-item">
    <a href="mailto:ishankumar216@gmail.com" title="Email me">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fas fa-envelope fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">Email me</span>
   </a>
  </li><li class="list-inline-item">
    <a href="https://www.facebook.com/ishan.kumar.790" title="Facebook">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fab fa-facebook fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">Facebook</span>
   </a>
  </li><li class="list-inline-item">
    <a href="https://github.com/Ishan-Kumar2" title="GitHub">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fab fa-github fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">GitHub</span>
   </a>
  </li><li class="list-inline-item">
    <a href="https://twitter.com/ishankumar216" title="Twitter">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">Twitter</span>
   </a>
  </li><li class="list-inline-item">
    <a href="https://linkedin.com/in/ishan-k216" title="LinkedIn">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">LinkedIn</span>
   </a>
  </li><li class="list-inline-item">
    <a href="https://scholar.google.com/https://scholar.google.com/citations?user=Lp0-GgIAAAAJ&hl=en" title="Google Scholar">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fa fa-graduation-cap fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">Google Scholar</span>
    </a>
  </li><li class="list-inline-item">
    <a href="https://medium.com/@ishankumar216" title="Medium">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fab fa-medium fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">Medium</span>
    </a>
  </li></ul>

      
      <p class="copyright text-muted">
      
        Ishan Kumar
        &nbsp;&bull;&nbsp;
      
      2023

      

      
      </p>
      <p class="theme-by text-muted">
        Powered by
        <a href="https://beautifuljekyll.com">Beautiful Jekyll</a>
      </p>
      </div>
    </div>
  </div>
</footer>


  
  
    
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" crossorigin="anonymous"></script>


  
    
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>


  
    
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>


  



  
    <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
    
      <script src="/assets/js/beautifuljekyll.js"></script>
    
  









</body>
</html>
